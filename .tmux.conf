unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

bind q display-popup -E "tmux new-session 'bash -ic cht_tmux'"
bind h display-popup -E "tmux new-session 'bash -ic hoogle_tmux'"

# start a non-login shell instead of a login shell
set -g default-command "$SHELL"

# set TMUX_DE to indicate if tmux is being run in a desktop environment or not
# set to TRUE if DISPLAY environment variable is set, or if kernel release string contains Darwin or Microsoft (assume we're using wsl)
run-shell 'tmux setenv -g TMUX_DE "$([ -n "$DISPLAY" ] || uname -a | grep -q "Microsoft\|Darwin" && echo TRUE)"'

# set terminal to 256 colors if we're in a desktop environment otherwise assume we only have 8 colors
if-shell '[ -z "$TMUX_DE" ]' "set -g default-terminal screen" "set -g default-terminal screen-256color"
# tell tmux that outside terminal supports true color
if-shell '[ -z "$TMUX_DE" ]' "" "set -ga terminal-overrides ',xterm-256color*:Tc'"

bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'V' send -X select-line
# set copy behavior based on desktop environment
if-shell '[ -z "$TMUX_DE" ]' "bind-key -T copy-mode-vi 'y' send -X copy-selection-and-cancel" "bind-key -T copy-mode-vi 'y' send -X copy-pipe-and-cancel 'xclip -selection clipboard -i'"

bind-key -r n next-window
bind-key -r p previous-window
set -g repeat-time 250

set -g mouse on
set -g mode-keys vi
set -g status-keys vi
set-option -g allow-rename off

# activity/bells
set-option -g visual-activity off
set-option -g visual-bell off
set-option -g visual-silence off
set-option -g bell-action none
set-window-option -g monitor-activity on

# statusbar
set -g status-interval 1
set -g status-position bottom
set -g status-justify centre
set -g status-style bg=color8
set -g status-left ''
set -g status-right '#[fg=color1]#(cat /sys/class/power_supply/*/capacity)%#[fg=color4] | #[fg=color3]%m/%d#[fg=color4] | #[fg=color3]%H:%M:%S '

# active window
setw -g window-status-current-style bg=color0
setw -g window-status-current-format ' #[fg=color1]#I #[fg=color3]#W#[fg=color4]#F '

# inactive window
setw -g window-status-style bg=color8
setw -g window-status-format ' #[fg=color88]#I #[fg=color94]#W#[fg=color4]#F '

# inactive window with activity
setw -g window-status-activity-style bg=color233

# panes
set -g pane-border-style fg=color8
set -g pane-active-border-style fg=color3

# highlighting
setw -g mode-style bg=color3,fg=color0

# console
set -g message-style bg=color0,fg=color3
