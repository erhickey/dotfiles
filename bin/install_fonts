#!/usr/bin/env bash

function get_file {
  source_file="$1"
  target_file="$2"
  pretty_label="$3"

  printf 'Retrieving %s...' "$pretty_label"
  (curl -fLso "$target_file" --create-dirs "$source_file" && \
    printf 'done\n') || printf 'FAILED !!!\n'
}

if uname -a | grep -q 'Darwin' ; then
  get_file https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/LiberationMono/LiterationMonoNerdFont-Regular.ttf ~/Downloads/Literation-Mono-Nerd-Font-Regular.ttf 'Literation Mono Nerd Font'
  get_file https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/LiberationMono/LiterationMonoNerdFont-Bold.ttf ~/Downloads/Literation-Mono-Nerd-Font-Bold.ttf 'Literation Mono Nerd Font Bold'
  get_file https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/LiberationMono/LiterationMonoNerdFont-Italic.ttf ~/Downloads/Literation-Mono-Nerd-Font-Italic.ttf 'Literation Mono Nerd Font Italic'
  get_file https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/LiberationMono/LiterationMonoNerdFont-BoldItalic.ttf ~/Downloads/Literation-Mono-Nerd-Font-Bold-Italic.ttf 'Literation Mono Nerd Font Bold Italic'
  open ~/Downloads/Literation-Mono-Nerd-Font-Regular.ttf
  open ~/Downloads/Literation-Mono-Nerd-Font-Bold.ttf
  open ~/Downloads/Literation-Mono-Nerd-Font-Italic.ttf
  open ~/Downloads/Literation-Mono-Nerd-Font-Bold-Italic.ttf
else
  printf 'installing fonts\nsudo '
  GET_FILE="$(declare -f get_file)"
  sudo sh -c "$GET_FILE ; get_file https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/LiberationMono/LiterationMonoNerdFont-Regular.ttf /usr/share/fonts/TTF/Literation-Mono-Nerd-Font-Regular.ttf 'Literation Mono Nerd Font'"
  sudo sh -c "$GET_FILE ; get_file https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/LiberationMono/LiterationMonoNerdFont-Bold.ttf /usr/share/fonts/TTF/Literation-Mono-Nerd-Font-Bold.ttf 'Literation Mono Nerd Font Bold'"
  sudo sh -c "$GET_FILE ; get_file https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/LiberationMono/LiterationMonoNerdFont-Italic.ttf /usr/share/fonts/TTF/Literation-Mono-Nerd-Font-Italic.ttf 'Literation Mono Nerd Font Italic'"
  sudo sh -c "$GET_FILE ; get_file https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/LiberationMono/LiterationMonoNerdFont-BoldItalic.ttf /usr/share/fonts/TTF/Literation-Mono-Nerd-Font-Bold-Italic.ttf 'Literation Mono Nerd Font Bold Italic'"
  printf '\nRebuilding font cache...\n'
  fc-cache -f -v
fi
